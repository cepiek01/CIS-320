CREATE VIEW VORDERTOTAL AS  
SELECT PONumber, SUM(QUANTITY*COST) AS ORDERTOTAL 
FROM PET..OrderItem 
GROUP BY PONumber; 
  
CREATE VIEW VSHIPPINGCOST AS 
SELECT PONumber, SupplierID, ShippingCost 
FROM PET..MerchandiseOrder; 
  
  
SELECT TOP 1 S.SupplierID, S.Name, AVG(C.SHIPPINGCOST/T.ORDERTOTAL) AS PctShipCost 
FROM PET..Supplier S INNER JOIN VSHIPPINGCOST C ON S.SupplierID=C.SupplierID INNER JOIN VORDERTOTAL T ON C.PONumber=T.PONumber 
GROUP BY S.SupplierID,S.Name; 
 
